(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{786:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return d}));n(299);var r=n(0),o=n(29),a=n(28),i=n(130),c=n(218),u=n(150),s=n(781),l=(n(15),n(7),n(48),n(20),n(23),n(774));function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var o=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var h=function(t){Object(i.a)(n,t);var e=f(n);function n(){return Object(a.a)(this,n),e.call(this,"start")}return Object(o.a)(n)}(Object(s.a)(Event)),v=function(t){Object(i.a)(n,t);var e=f(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)(this,n),(t=e.call(this,"progress")).progress=r.progress,t.item=r.item,t}return Object(o.a)(n)}(Object(s.a)(Event)),b=function(t){Object(i.a)(n,t);var e=f(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)(this,n),(t=e.call(this,"fileLoad")).result=r.result,t.item=r.item,t}return Object(o.a)(n)}(Object(s.a)(Event)),O=function(t){Object(i.a)(n,t);var e=f(n);function n(t){return Object(a.a)(this,n),e.call(this,"fileError",{error:t})}return Object(o.a)(n)}(Object(s.a)(ErrorEvent)),p=function(t){Object(i.a)(n,t);var e=f(n);function n(){return Object(a.a)(this,n),e.call(this,"complete")}return Object(o.a)(n)}(Object(s.a)(Event)),j=function(t){Object(i.a)(n,t);var e=f(n);function n(t){var r;return Object(a.a)(this,n),(r=e.call(this,"error",{error:t&&t[0]})).errors=t,r}return Object(o.a)(n)}(Object(s.a)(ErrorEvent)),d=function(t){Object(i.a)(c,t);var e,n=f(c);function c(t){var e;return Object(a.a)(this,c),(e=n.call(this))._maxConnection=10,e._loadStartTime=0,e._loading=Promise.resolve(),e._queue=[],e.setMaxConnections(t),e}return Object(o.a)(c,[{key:"load",value:function(t){var e=this,n=this._loadStartTime=Date.now();return this._loading=this._loading.then((function(){return new Promise((function(r){var o=t.slice(),a=t.length,i=[];e._onLoadStart();for(var c=new Array(e._maxConnection),u=0;u<c.length;u++)c[u]=e._startWorker(u,o,i,a);Promise.all(c).then((function(){i.length>0&&e._onError(i)})).catch((function(t){e._onError([t])})).then((function(){e._loadStartTime==n&&e._onComplete(),r()}))}))}))}},{key:"_startWorker",value:(e=Object(r.a)(regeneratorRuntime.mark((function t(e,n,r,o){var a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=n.shift())){t.next=16;break}return this._onProgress(1-n.length/o,a),t.prev=2,t.next=5,this._loadImage(a.src);case 5:i=t.sent,this._onFileLoad(i,a),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(2),t.t0.item=a,r.push(t.t0),this._onFileError(t.t0);case 14:t.next=0;break;case 16:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(t,n,r,o){return e.apply(this,arguments)})},{key:"_loadImage",value:function(t){var e=new Image;return new Promise((function(n,r){e.crossOrigin="anonymous",e.onload=function(){return n(e)},e.onerror=r,e.src=t}))}},{key:"setMaxConnections",value:function(t){t>0&&(this._maxConnextion=t)}},{key:"_onLoadStart",value:function(){this.dispatchEvent(new h)}},{key:"_onProgress",value:function(t,e){this.dispatchEvent(new v({progress:t,item:e}))}},{key:"_onFileLoad",value:function(t,e){this.dispatchEvent(new b({result:t,item:e}))}},{key:"_onFileError",value:function(t){this.dispatchEvent(new O(t))}},{key:"_onComplete",value:function(t){this.dispatchEvent(new p)}},{key:"_onError",value:function(t){this.dispatchEvent(new j(t))}}]),c}(l.EventTarget)}}]);