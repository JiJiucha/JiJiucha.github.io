(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{627:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return x}));r(299),r(48),r(19),r(39),r(20),r(25),r(54),r(23);var n=r(36),a=r(0),u=r(28),c=r(29),i=r(130),s=r(218),o=r(150),f=r(1),p=r(18),l=(r(15),r(30),r(49),r(7),r(423),r(42),r(22),r(221));function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,c=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,u=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw u}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(o.a)(e);if(t){var a=Object(o.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(s.a)(this,r)}}var d=Symbol("private"),b=Object(p.a)("instance"),x=function(e){Object(i.a)(j,e);var t,r,s,o,p,l,v,x,k,g,w,y,R,O=h(j);function j(e){if(Object(u.a)(this,j),e!==d)throw new Error("constructor is private");return O.call(this,j.STORE_NAME)}return Object(c.a)(j,[{key:"clear",value:(R=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transaction("rw",(function(e){return e.clear()}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"getAll",value:(y=Object(a.a)(regeneratorRuntime.mark((function e(){var t,r,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],e.next=3,this.transaction((function(e){return e.getAll()}));case 3:return r=e.sent,e.abrupt("return",r.filter((function(e){return!0===t||1!==e.removed})).sort((function(e,t){return t.timestamp-e.timestamp})));case 6:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"count",value:(w=Object(a.a)(regeneratorRuntime.mark((function e(){var t,r=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]&&r[0],e.next=3,this.transaction((function(e){return t?e.count():e.index("removed").count(0)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"get",value:(g=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(t),e.next=3,this.transaction((function(e){return e.get(t)}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"has",value:(k=Object(a.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(t),e.next=3,this.get(t);case 3:return r=e.sent,e.abrupt("return",r&&1!==r.removed);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"saveAll",value:(x=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Array.isArray(t)||(t=[t]),e.next=3,this.transaction("rw",function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(r){var n,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=m(t),e.prev=1,n.s();case 3:if((a=n.n()).done){e.next=19;break}return u=a.value,e.prev=5,e.next=8,r.count(u);case 8:if(e.t0=e.sent,0!=e.t0){e.next=12;break}return e.next=12,r.add({image_maker_id:u,unsent:0,removed:0,timestamp:new Date});case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(5);case 17:e.next=3;break;case 19:e.next=24;break;case 21:e.prev=21,e.t2=e.catch(1),n.e(e.t2);case 24:return e.prev=24,n.f(),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[1,21,24,27],[5,14]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"add",value:(v=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(t),e.next=4,this.transaction("rw",function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(t);case 2:if(1!==(null==(n=e.sent)?void 0:n.removed)){e.next=12;break}return n.removed=0,n.unsent=0,n.timestamp=new Date,e.next=10,r.put(n);case 10:e.next=14;break;case 12:return e.next=14,r.put({image_maker_id:t,unsent:1,removed:0,timestamp:new Date});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"remove",value:(l=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=parseInt(t),e.next=4,this.transaction("rw",function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.get(t);case 2:if(!(n=e.sent)){e.next=17;break}if(1===n.removed){e.next=15;break}if(1!==n.unsent){e.next=10;break}return e.next=8,r.delete(t);case 8:e.next=15;break;case 10:return n.unsent=1,n.removed=1,n.timestamp=new Date,e.next=15,r.put(n);case 15:e.next=19;break;case 17:return e.next=19,r.put({image_maker_id:t,unsent:1,removed:1,timestamp:new Date});case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getByUnsent",value:(p=Object(a.a)(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transaction((function(e){return e.index("unsent").getAll(1)}));case 2:return t=e.sent,r={r:[],d:[]},t.forEach((function(e){0===e.removed?r.r.push(e.image_maker_id):r.d.push(e.image_maker_id)})),0==r.r.length&&delete r.r,0==r.d.length&&delete r.d,e.abrupt("return",r.r||r.d?r:null);case 8:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"removeSent",value:(o=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transaction("rw",function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(t){var r,n,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.index("unsent").getAll();case 2:r=e.sent,n=m(r),e.prev=4,n.s();case 6:if((a=n.n()).done){e.next=13;break}if(0!=(u=a.value).unsent){e.next=11;break}return e.next=11,t.delete(u.image_maker_id);case 11:e.next=6;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[4,15,18,21]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"removeUnsent",value:(s=Object(a.a)(regeneratorRuntime.mark((function e(t){var r,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>1&&void 0!==u[1]&&u[1],e.next=3,this.transaction("rw",function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(a){var u,c,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=t.r||[],r||u.push.apply(u,Object(n.a)(t.d||[])),c=m(u),e.prev=3,c.s();case 5:if((i=c.n()).done){e.next=11;break}return s=i.value,e.next=9,a.delete(parseInt(s));case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),c.e(e.t0);case 16:return e.prev=16,c.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"updateToSent",value:(r=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transaction("rw",function(){var e=Object(a.a)(regeneratorRuntime.mark((function e(r){var n,a,u,c,i,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.r){e.next=23;break}n=m(t.r),e.prev=2,n.s();case 4:if((a=n.n()).done){e.next=15;break}return u=a.value,e.next=8,r.get(parseInt(u));case 8:if(1!=(null==(c=e.sent)?void 0:c.unsent)){e.next=13;break}return c.unsent=0,e.next=13,r.put(c);case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),n.e(e.t0);case 20:return e.prev=20,n.f(),e.finish(20);case 23:if(!t.d){e.next=41;break}i=m(t.d),e.prev=25,i.s();case 27:if((s=i.n()).done){e.next=33;break}return o=s.value,e.next=31,r.delete(parseInt(o));case 31:e.next=27;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e.catch(25),i.e(e.t1);case 38:return e.prev=38,i.f(),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[2,17,20,23],[25,35,38,41]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}],[{key:"create",value:(t=Object(a.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=Object(f.a)(this,b)[b]){e.next=4;break}return Object(f.a)(this,b)[b]=new this(d),e.next=4,Object(f.a)(this,b)[b].open();case 4:return e.abrupt("return",Object(f.a)(this,b)[b]);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),j}(l.a);x.STORE_NAME="bookmark",Object.defineProperty(x,b,{writable:!0,value:null})}}]);